# UT_ServiceTypical

## 概述

`UT_ServiceTypical` 是用于验证 IOC 服务 API 典型使用场景的单元测试文件。该测试确保服务的上线、连接、事件订阅与取消订阅等功能按预期工作。

## 用户故事

### US-1：作为一个事件生产者（EvtProducer）

我希望上线一个或多个具有自定义 URI 的服务，以便事件消费者（EvtConsumers）可以连接到我的服务。每个消费者可以订阅我在连接的链接上发布的所有或部分事件，且任何消费者都可以随时取消订阅其订阅的事件。

### US-2：作为一个事件消费者（EvtConsumer）

我也希望上线一个服务，以便事件生产者（EvtProducers）可以连接到我的服务，并在连接的链接上发布事件。

### US-3 至 US-6

同样的场景适用于：

- 指令发起者（CmdInitiator）与指令执行者（CmdExecutor）
- 数据发送者（DatSender）与数据接收者（DatReceiver）

### US-7：作为一个事件生产者（EvtProducer）

我希望上线一个带有广播标志的服务，这样当多个事件消费者连接到我的服务时，我可以通过一次 API 调用将事件发布到所有连接的链接。

## 验收标准

### 对于 US-1

#### AC-1

- **前提**：事件生产者已上线服务。
- **当**：事件消费者连接到服务并建立链接。
- **那么**：消费者可以订阅事件，生产者可以发布事件，消费者能够处理这些事件。
- **当**：消费者取消订阅事件。
- **那么**：生产者发布事件将得到 `NO_EVENT_CONSUMER` 的结果，消费者将不再处理该事件。

#### AC-2

- **前提**：事件生产者已上线服务。
- **当**：多个事件消费者连接到服务并各自建立链接。
- **那么**：每个消费者可以在自己的链接上订阅不同的事件。
- **当**：生产者向所有链接发布事件。
- **那么**：每个消费者只会处理其订阅的事件。

#### AC-3

- **前提**：事件生产者已上线多个具有不同 URI 的服务。
- **当**：事件消费者连接到每个服务并建立链接。
- **那么**：消费者可以在每个链接上订阅事件，生产者可以向每个链接发布事件，消费者能够处理这些事件。

### 对于 US-2

#### AC-1

- **前提**：事件消费者已上线多个具有不同 URI 的服务。
- **当**：多个事件生产者连接到每个服务并建立链接。
- **那么**：生产者可以向每个链接发布事件，消费者能够处理这些事件，与 US-1 的 AC-3 类似。

## 测试用例

### TC-1：验证单个服务和单个客户端

- **目标**：验证一个事件生产者作为服务器，一个事件消费者作为客户端的典型场景。
- **对应验收标准**：US-1 的 AC-1。

### TC-2：验证单个服务和多个客户端

- **目标**：验证多个事件消费者可以在各自的链接上订阅不同的事件。
- **对应验收标准**：US-1 的 AC-2。

### TC-3：验证多个服务和多个客户端

- **目标**：验证具有不同 URI 的多个服务可以由同一事件生产者上线，每个事件消费者连接到各自的服务并订阅和处理事件。
- **对应验收标准**：US-1 的 AC-3。

### TC-4：验证消费者作为服务器的场景

- **目标**：验证事件消费者上线服务，事件生产者连接并发布事件，消费者处理这些事件。
- **对应验收标准**：US-2 的 AC-1。

## 结论

`UT_ServiceTypical` 通过模拟多种典型的使用场景，验证了事件生产者和消费者之间的交互，确保了服务机制的正确性和稳定性。


## TODO: More...
### TC-5：验证消费者的重新订阅功能

- **目标**：验证事件消费者在取消订阅事件后，能够重新订阅事件并正常接收。
- **对应验收标准**：US-1 的 AC-1 扩展。

### TC-6：验证无消费者订阅时生产者的处理

- **目标**：验证当没有事件消费者订阅时，事件生产者发布事件的行为。
- **对应验收标准**：US-1 的 AC-1。

### TC-7：验证消费者订阅多个事件

- **目标**：验证事件消费者可以同时订阅多个事件。
- **对应验收标准**：US-1 的功能要求。

### TC-8：验证广播模式下事件发布

- **目标**：验证事件生产者在广播模式下，事件能够发送给所有已连接的事件消费者。
- **对应验收标准**：US-7。

### TC-9：验证服务的负载能力

- **目标**：在高并发情况下验证服务的稳定性和性能。
- **对应验收标准**：性能和稳定性要求。

### TC-10：验证服务 URI 的唯一性

- **目标**：验证当使用已占用的 URI 上线服务时，系统的处理情况。
- **对应验收标准**：服务注册的唯一性要求。

### TC-11：验证服务下线后的消费者处理

- **目标**：验证事件消费者在服务下线后能够正确处理。
- **对应验收标准**：系统健壮性要求。

### TC-12：验证不同类型服务之间的交互

- **目标**：验证指令发起者与执行者、数据发送者与接收者之间的交互是否正常。
- **对应验收标准**：US-3 至 US-6。

### TC-13：验证异常情况下的连接处理

- **目标**：验证在网络异常、服务异常等情况下，系统的健壮性。
- **对应验收标准**：系统容错性要求。

### TC-14：验证消费者的权限控制

- **目标**：验证只有具备正确权限的消费者才能订阅特定事件。
- **对应验收标准**：安全性要求。

### TC-15：验证服务的负载均衡

- **目标**：当有多个相同功能的服务实例时，验证消费者能够均衡地连接到不同的服务实例。
- **对应验收标准**：可扩展性要求。